<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" lasteditedby="rbwinst-pr" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title translate="true">Solver Options 1</title>
  <body>
    <header>
      <para styleclass="Heading1"><text styleclass="Heading1" translate="true">Solver Options 1</text></para>
    </header>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The Solver Options 1 pane is on the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWR_Surface_Water_Routing_Proc" styleclass="Normal" translate="true">SWR: Surface-Water Routing Process Pane</link><text styleclass="Normal" translate="true"> of the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="MODFLOW_Packages_Dialog_Box" styleclass="Normal" translate="true">MODFLOW Packages and Programs Dialog Box</link><text styleclass="Normal" translate="true">.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The Solver Options 1 pane is used to specify parameters related to solving the surface-water flow equations.</text></para>
    <para styleclass="Normal"><anchor id="ISOLVER" styleclass="Strong"></anchor><text styleclass="Strong" translate="true">Solver (ISOLVER)</text><text styleclass="Normal" translate="true">: ISOLVER defines the solver used by the SWR1 Process to solve the defined surface-water equations for each reach group.</text></para>
    <list id="4" type="ul" listtype="bullet" formatstring="&#183;" format-charset="SYMBOL_CHARSET" levelreset="true" legalstyle="false" startfrom="1" styleclass="Normal" style="font-family:Symbol; font-size:12pt; color:#000000;">
      <li styleclass="Normal"><text styleclass="Normal" translate="true">ISOLVER = 1, LU decomposition using Crout’s algorithm (Crout, 1941) based on Press and others (1990, 1999).</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">ISOLVER = 2, Biconjugate gradient stabilized method (bi-CGSTAB) based on Barrett and others (1994), and Kelley (1995).</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">ISOLVER = 3, GMRES method based on Brown and Saad (1990), Jones and Woodward (2001), and Saad and Schultz (1986).</text></li>
    </list>
    <para styleclass="Strong"><text styleclass="Strong" translate="true">Maximum number of outer iterations (NOUTER)</text><text styleclass="Normal" translate="true">: </text><text styleclass="Font Style" style="font-family:&apos;Times New Roman&apos;; font-size:12pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;" translate="true">NOUTER defines the maximum number of outer iterations used to resolve non-linearities for all solvers. NOUTER must be &gt; 0 and is generally less than 100. </text></para>
    <para styleclass="Strong"><text styleclass="Strong" translate="true">Maximum number of inner iterations (NINNER)</text><text styleclass="Normal" translate="true">: NINNER defines the maximum number of inner iterations used within the preconditioned biconjugate gradient solver (ISOLVER = 2) and GMRES solver (ISOLVER = 3). NINNER also defines the maxi­mum number of iterations to perform before restarting GMRES (ISOLVER = 3) and reduced storage requirements for the method. Typical values for the biconjugate gradient stabilized method range from 10 to 30. Typical values for the GMRES method range from 5 to 30. NINNER is not used for ISOLVER = 1 and can be set to any positive value greater than 0. </text></para>
    <para styleclass="Strong"><anchor id="IBT" styleclass="Strong"></anchor><text styleclass="Strong" translate="true">Maximum number of line search iterations (IBT)</text><text styleclass="Normal" translate="true">: IBT defines whether line search is enabled (IBT &gt; 1) or disabled (IBT ≤ 1). IBT also defines the maximum number of line search iterations to perform (if IBT &gt; 1) at the end of each outer iteration to minimize the ℓ2-norm using Brent’s method (Press and others, 1990). Line search should be disabled (IBT ≤ 1) if </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWR_Solver_Options_1" anchor="DAMPSS" styleclass="Normal" translate="true">DAMPSS</link><text styleclass="Normal" translate="true"> and/or </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWR_Solver_Options_1" anchor="DAMPTR" styleclass="Normal" translate="true">DAMPTR</link><text styleclass="Normal" translate="true"> values other than 1.0 are specified.</text></para>
    <para styleclass="Strong"><text styleclass="Strong" translate="true">Stage tolerance (TOLS)</text><text styleclass="Normal" translate="true">: TOLS—a real value that defines the tolerance level for reach group stages used to evaluate convergence for stage within the selected numerical solver and to trigger increases and decreases in the SWR1 time step when adaptive time step­ping is enabled. Value is in units of length and must be consistent with the MODFLOW length unit. Usually a value of 1.0×10</text><text style="font-family:&apos;Times New Roman&apos;; font-size:8pt; vertical-align:super; color:#000000;" translate="true">-9</text><text styleclass="Normal" translate="true"> is sufficient when units of feet or meters are used in the model.</text></para>
    <para styleclass="Strong"><text styleclass="Strong" translate="true">Flow tolerance option</text><text styleclass="Normal" translate="true">: This option determines what </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWR_Solver_Options_2" anchor="PTOLR" styleclass="Normal" translate="true">PTOLR</link><text styleclass="Normal" translate="true"> means. There are three options.</text></para>
    <list id="5" type="ul" listtype="bullet" formatstring="&#183;" format-charset="SYMBOL_CHARSET" levelreset="true" legalstyle="false" startfrom="1" styleclass="Strong" style="font-family:Symbol; font-size:12pt; color:#000000;">
      <li styleclass="Strong"><text styleclass="Strong" translate="true">None</text><text styleclass="Normal" translate="true">: </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWR_Solver_Options_2" anchor="PTOLR" styleclass="Normal" translate="true">PTOLR</link><text styleclass="Normal" translate="true"> is not used.</text></li>
      <li styleclass="Strong"><anchor id="USE_FRACTIONAL_TOLR" styleclass="Strong"></anchor><text styleclass="Strong" translate="true">USE_FRACTIONAL_TOLR</text><text styleclass="Normal" translate="true">: The </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWR_Solver_Options_2" anchor="PTOLR" styleclass="Normal" translate="true">PTOLR</link><text styleclass="Normal" translate="true"> value specified in Item 3 represents a fractional value. Residual convergence is achieved when the ratio of the residual to the average of the inflow and outflow for a reach group is less than or equal to </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWR_Solver_Options_2" anchor="PTOLR" styleclass="Normal" translate="true">PTOLR</link><text styleclass="Normal" translate="true">.</text></li>
      <li styleclass="Strong"><anchor id="USE_L2NORM_TOLR" styleclass="Strong"></anchor><text styleclass="Strong" translate="true">USE_L2NORM_TOLR</text><text styleclass="Normal" translate="true">: The </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWR_Solver_Options_2" anchor="PTOLR" styleclass="Normal" translate="true">PTOLR</link><text styleclass="Normal" translate="true"> value specified in Item 3 represents a ℓ2-norm. Residual convergence is achieved when the ℓ2-norm for all active reach groups is less than or equal to </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWR_Solver_Options_2" anchor="PTOLR" styleclass="Normal" translate="true">PTOLR</link><text styleclass="Normal" translate="true">.</text></li>
    </list>
    <para styleclass="Strong"><text styleclass="Strong" translate="true">Flow tolerance (TOLR)</text><text styleclass="Normal" translate="true">: TOLR defines the tolerance level for reach group flow residuals to evaluate convergence for flow within the selected numerical solver and to trigger increases and decreases in the SWR1 time step when adaptive time stepping is enabled. Value is in units of length cubed per time, and must be consistent with MODFLOW length and time units. Usually a value of 1.0×10</text><text style="font-family:&apos;Times New Roman&apos;; font-size:8pt; vertical-align:super; color:#000000;" translate="true">-1</text><text styleclass="Normal" translate="true"> is sufficient for the flow-residual criteria when meters and seconds are the defined MODFLOW length and time.</text></para>
    <para styleclass="Strong"><text styleclass="Strong" translate="true">Exchange tolerance option</text><text styleclass="Normal" translate="true">: The exchange tolerance option determines what </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWR_Solver_Options_1" anchor="TOLA" styleclass="Normal" translate="true">TOLA</link><text styleclass="Normal" translate="true"> means.</text></para>
    <list id="6" type="ul" listtype="bullet" formatstring="&#183;" format-charset="SYMBOL_CHARSET" levelreset="true" legalstyle="false" startfrom="1" styleclass="Strong" style="font-family:Symbol; font-size:12pt; color:#000000;">
      <li styleclass="Strong"><text styleclass="Strong" translate="true">None</text><text styleclass="Normal" translate="true">: </text></li>
      <li styleclass="Strong"><text styleclass="Strong" translate="true">USE_GLOBAL_TOLA</text><text styleclass="Normal" translate="true">: The </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWR_Solver_Options_1" anchor="TOLA" styleclass="Normal" translate="true">TOLA</link><text styleclass="Normal" translate="true"> value specified in Item 3 represents a global surface-water/groundwater exchange convergence criterion. Surface-water/groundwater exchange convergence is achieved when the absolute value of sum of the discrepancies between MODFLOW and SWR1 for all active reaches is less than or equal to </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWR_Solver_Options_1" anchor="TOLA" styleclass="Normal" translate="true">TOLA</link><text styleclass="Normal" translate="true">.</text></li>
      <li styleclass="Strong"><text styleclass="Strong" translate="true">USE_ABSOLUTE_TOLA</text><text styleclass="Normal" translate="true">: The </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWR_Solver_Options_1" anchor="TOLA" styleclass="Normal" translate="true">TOLA</link><text styleclass="Normal" translate="true"> value specified in Item 3 represents an absolute surface-water/groundwater exchange convergence criterion. Surface-water/groundwater exchange convergence is achieved when the absolute value of the discrepancy between MODFLOW and SWR1 for each active reaches is less than or equal to </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWR_Solver_Options_1" anchor="TOLA" styleclass="Normal" translate="true">TOLA</link><text styleclass="Normal" translate="true">.</text></li>
    </list>
    <para styleclass="Strong"><anchor id="TOLA" styleclass="Strong"></anchor><text styleclass="Strong" translate="true">Exchange tolerance (TOLA)</text><text styleclass="Normal" translate="true">: TOLA defines the tolerance level for relative differences in surface-water/groundwater exchanges between SWR1 and MODFLOW at the end of each MODFLOW outer iteration (Picard iteration). Convergence of surface-water/groundwater exchanges between successive MODFLOW outer iterations is disabled if TOLA is less than or equal to zero. Disabling the tolerance level for surface-water/groundwater exchanges may be appropriate for models in which groundwater levels do not change noticeably from one MODFLOW time step to another; the validity of this assumption can be evaluated by looking at the differences in SWR1 and MODFLOW calculated aquifer-reach exchanges printed in the MODFLOW listing file. Use of TOLA may improve results in cases where use of lagged heads in SWR1 formulate subroutines (GWF2SWR1FM) allow convergence of MODFLOW’s iterative solvers on the first outer iteration but will increase run-times. Value is relative and unitless. Usually a value of 0.01 is sufficient.</text></para>
    <para styleclass="Strong"><anchor id="DAMPSS" styleclass="Strong"></anchor><text styleclass="Strong" translate="true">Steady state damping factor (DAMPSS) </text><text styleclass="Normal" translate="true">: DAMPSS defines the steady-state dampening factor that is applied for each inner iteration of the selected linear solver. Acceleration can be applied to the inner iteration of the selected linear solver by specifying DAMPSS values greater than 1.0. DAMPSS values between 0.1 and 0.5 have been found to work well for steady-state stress periods. Dampening/acceleration is not applied if a DAMPSS value of 0.0 is specified (DAMPSS is reset to 1.0). DAMPSS should be set to 1.0 if </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWR_Solver_Options_1" anchor="IBT" styleclass="Normal" translate="true">IBT</link><text styleclass="Normal" translate="true"> is greater than 1.</text></para>
    <para styleclass="Strong"><anchor id="DAMPTR" styleclass="Strong"></anchor><text styleclass="Strong" translate="true">Transient damping factor (DAMPTR)</text><text styleclass="Normal" translate="true">: DAMPTR defines the transient dampening factor that is applied for each inner iteration of the selected linear solver. Acceleration can be applied to the inner iteration of the selected linear solver by specifying DAMPTR values greater than 1.0. Dampening/acceleration is not applied if a DAMPTR value less than or equal to 0.0 is specified (DAMPTR is reset to 1.0). DAMPTR should be set to 1.0 if </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWR_Solver_Options_1" anchor="IBT" styleclass="Normal" translate="true">IBT</link><text styleclass="Normal" translate="true"> is greater than 1.</text></para>
    <para styleclass="Strong"><text styleclass="Strong" translate="true">Convergence printout interval (IPRSWR)</text><text styleclass="Normal" translate="true">: IPRSWR is the printout interval for convergence information for the SWR1 Process. SWR1 convergence information is written to the MODFLOW listing file every IPRSWR MODFLOW time steps. If IPRSWR is less than 1 it is changed to 999. This printout also occurs at the end of each MODFLOW stress period regardless of the value of IPRSWR.</text></para>
    <para styleclass="Strong"><text styleclass="Strong" translate="true">Print convergence (MUTSWR)</text><text styleclass="Normal" translate="true">: MUTSWR controls printing of convergence information for the SWR1 Process. There are four choices.</text></para>
    <list id="7" type="ul" listtype="bullet" formatstring="&#183;" format-charset="SYMBOL_CHARSET" levelreset="true" legalstyle="false" startfrom="1" styleclass="Strong" style="font-family:Symbol; font-size:12pt; color:#000000;">
      <li styleclass="Strong"><text styleclass="Strong" translate="true">Print max residual every time step (0)</text><text styleclass="Normal" translate="true">: Print</text><text styleclass="Font Style" style="font-family:&apos;Times New Roman&apos;; font-size:12pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;" translate="true"> tables of the final maximum absolute residual for each SWR1 time step.</text></li>
      <li styleclass="Strong"><text styleclass="Strong" translate="true">Print number of iterations (1)</text><text styleclass="Normal" translate="true">: Print</text><text styleclass="Font Style" style="font-family:&apos;Times New Roman&apos;; font-size:12pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;" translate="true"> only the total number of iterations in each SWR1 time step.</text></li>
      <li styleclass="Strong"><text styleclass="Strong" translate="true">Print none (2)</text><text styleclass="Normal" translate="true">: N</text><text styleclass="Font Style" style="font-family:&apos;Times New Roman&apos;; font-size:12pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;" translate="true">o printing.</text></li>
      <li styleclass="Strong"><text styleclass="Strong" translate="true">Print if convergence fails (3)</text><text styleclass="Normal" translate="true">: Print</text><text styleclass="Font Style" style="font-family:&apos;Times New Roman&apos;; font-size:12pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;" translate="true"> only if convergence fails for at least one SWR1 time step in a MODFLOW time step.</text></li>
    </list>
  </body>
</topic>
