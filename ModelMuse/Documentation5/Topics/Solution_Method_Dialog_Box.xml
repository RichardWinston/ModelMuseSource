<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title translate="true">PHAST Solution Method Dialog Box</title>
  <body>
    <header>
      <para style="margin-bottom:10px; line-height:2.0;"><text styleclass="Heading1" translate="true">PHAST Solution Method Dialog Box</text></para>
    </header>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The </text><text styleclass="Normal" style="font-weight:bold;" translate="true"> PHAST Solution Method</text><text styleclass="Normal" translate="true"> dialog box is used to control which solver is used and to set the parameters for the solver. &#160;The </text><text styleclass="Normal" style="font-weight:bold;" translate="true"> PHAST Solution Method</text><text styleclass="Normal" translate="true"> dialog box is displayed by selecting </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Model|PHAST Solution Method…</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The user can select either the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">direct</text><text styleclass="Normal" translate="true"> or </text><text styleclass="Normal" style="font-weight:bold;" translate="true">iterative</text><text styleclass="Normal" translate="true"> solver. &#160;For large problems, the iterative solver is more efficient.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The user can choose to include </text><text styleclass="Normal" style="font-weight:bold;" translate="true">cross dispersion</text><text styleclass="Normal" translate="true"> terms by checking the appropriate checkbox. &#160;For problems where there is flow at an angle to the grid, including the cross-dispersion terms can lead to a more accurate solution at the cost of an increased execution time. &#160;However, the cross-dispersion terms can also lead to negative concentrations. &#160;These will be set to zero in the chemical calculations, which leads to global mass-balance errors.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">Edit boxes are available to set the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">space-differencing</text><text styleclass="Normal" translate="true"> and </text><text styleclass="Normal" style="font-weight:bold;" translate="true">time-differencing</text><text styleclass="Normal" translate="true"> weighting. &#160;Space-differencing weighting and time-differencing weighting are important parameters because they help control the oscillation and numerical dispersion in the numerical solution. &#160;In general, centered-in-space and centered-in-time weightings (when both parameters are 0.5) reduces numerical dispersion, but can lead to oscillation of the solution. &#160;Upstream-in-space (space differencing = 0) and backwards-in-time (time differencing = 1) do not produce oscillations, but have more numerical dispersion (Parkhurst and others, 2004).</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">If the iterative solver is used, a </text><text styleclass="Normal" style="font-weight:bold;" translate="true">tolerance</text><text styleclass="Normal" translate="true"> must be specified in the related edit box. &#160;The tolerance determines when the solver has converged to a solution to the difference equations. &#160;The tolerance must be sufficiently small to obtain an accurate solution. </text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">If the iterative solver is used, the number of search directions to be saved (Save Directions) between restarts of the iterative solver must be specified in the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Save directions</text><text styleclass="Normal" translate="true"> edit box.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">Sometimes iterative solvers cannot converge for a particular problem. &#160;The user specifies the maximum number of iterations that will be allowed before the solver quits in the </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Maximum iterations</text><text styleclass="Normal" translate="true"> edit box.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Rebalance fraction</text><text styleclass="Normal" translate="true"> option applies only to the parallel version of PHAST. After each time step, PHAST evaluates how to optimally rebalance the cells among the processors for the chemical calculation. It estimates a number of cells to transfer from one processor to the next. The </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Rebalance fraction</text><text styleclass="Normal" translate="true"> is multiplied times the estimated number of cells to obtain the actual number of cells transferred. The default value is 0.5.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" style="font-weight:bold;" translate="true">Rebalance by cell</text><text styleclass="Normal" translate="true"> is used optionally used for the parallel version of PHAST. By default, PHAST looks at the total time taken to run chemistry on a block of cells and from that calculates the average time per cell, which is used to rebalance the load among the available processors. The new algorithm measures the time for each cell individually and rebalances based on this information. The new method should only be needed for kinetic problems where some cells take much longer to run than other cells. If </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Rebalance by cell</text><text styleclass="Normal" translate="true"> is checked</text><text styleclass="Normal" translate="true"> the new algorithm is used for parallel runs. &#160;Otherwise the original algorithm is used to rebalance workload for parallel runs. The default value is unchecked.</text></para>
  </body>
</topic>
